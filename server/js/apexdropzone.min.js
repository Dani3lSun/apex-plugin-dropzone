var $jscomp={scope:{},findInternal:function(b,a,c){b instanceof String&&(b=String(b));for(var d=b.length,f=0;f<d;f++){var g=b[f];if(a.call(c,g,f,b))return{i:f,v:g}}return{i:-1,v:void 0}}};$jscomp.defineProperty="function"==typeof Object.defineProperties?Object.defineProperty:function(b,a,c){if(c.get||c.set)throw new TypeError("ES3 does not support getters and setters.");b!=Array.prototype&&b!=Object.prototype&&(b[a]=c.value)};
$jscomp.getGlobal=function(b){return"undefined"!=typeof window&&window===b?b:"undefined"!=typeof global&&null!=global?global:b};$jscomp.global=$jscomp.getGlobal(this);$jscomp.polyfill=function(b,a,c,d){if(a){c=$jscomp.global;b=b.split(".");for(d=0;d<b.length-1;d++){var f=b[d];f in c||(c[f]={});c=c[f]}b=b[b.length-1];d=c[b];a=a(d);a!=d&&null!=a&&$jscomp.defineProperty(c,b,{configurable:!0,writable:!0,value:a})}};
$jscomp.polyfill("Array.prototype.find",function(b){return b?b:function(a,b){return $jscomp.findInternal(this,a,b).v}},"es6-impl","es3");
var apexDropzone={parseBoolean:function(b){var a;"true"==b.toLowerCase()&&(a=!0);"false"==b.toLowerCase()&&(a=!1);"true"!=b.toLowerCase()&&"false"!=b.toLowerCase()&&(a=void 0);return a},imageExists:function(b,a,c){try{var d=new Image;d.onload=a;d.onerror=c;d.src=b}catch(f){apex.debug.log("imageExists Error",f)}},clob2Array:function(b,a,c){loopCount=Math.floor(b.length/a)+1;for(var d=0;d<loopCount;d++)c.push(b.slice(a*d,a*(d+1)));return c},binaryArray2base64:function(b){var a="";b=new Uint8Array(b);
for(var c=b.byteLength,d=0;d<c;d++)a+=String.fromCharCode(b[d]);return btoa(a)},sleepUntil:function(b){for(var a=(new Date).getTime();new Date<a+b;);return!0},setUploadProgress:function(b,a,c){var d;b?(d=b.loaded/b.total*100,100<d&&(d=100),c.upload={progress:d,total:b.total,bytesSent:b.loaded}):(d=100,c.upload={progress:d,bytesSent:c.upload.total});a.emit("uploadprogress",c,d,c.size/(100/d))},setUploadProgressChunked:function(b,a,c,d,f){var g;b?(g=c/d*100+b.loaded/b.total*100/d,100<g&&(g=100),f.upload=
{progress:g,total:c/d*b.total,bytesSent:c/d*b.loaded}):(g=c/d*100,100<g&&(g=100),f.upload={progress:g,bytesSent:c/d*f.upload.total});a.emit("uploadprogress",f,g,f.size/(100/g))},asyncLoop:function(b,a,c){var d=1,f=!1,g={next:function(){f||(d<=b?(d++,a(g)):(f=!0,c()))},iteration:function(){return d-1},"break":function(){f=!0;c()}};g.next();return g},resizeImage:function(b,a,c){if((b.options.resizeWidth||b.options.resizeHeight)&&a.type.match(/image.*/)){var d=b.options.resizeMethod,d=b.options.resizeWidth&&
b.options.resizeHeight?"crop":"contain";b.resizeImage(a,b.options.resizeWidth,b.options.resizeHeight,d,function(b){b.name=a.name;b.status=a.status;b.accepted=a.accepted;b.processing=a.processing;b.lastModified=a.lastModified;b.lastModifiedDate=a.lastModifiedDate;b.previewElement=a.previewElement;b.previewTemplate=a.previewTemplate;b._removeLink=a._removeLink;c(b)})}else c(a)},uploadDzFiles:function(b,a,c,d,f){for(var g=0;g<c.length;g++){var e=c[g];apexDropzone.resizeImage(a,c[g],function(c){if(c){var g=
e;e=c}var h=new FileReader;h.onload=function(h){return function(p){if(h){c&&(e=g);p=apexDropzone.binaryArray2base64(p.target.result);var m=[],m=apexDropzone.clob2Array(p,3E4,m);a.emit("uploadprogress",e,10,e.size/10);e.xhr=apex.jQuery.ajax({dataType:"text",type:"POST",url:window.location.href.substr(0,window.location.href.indexOf("/f?p=")+1)+"wwv_flow.show",async:!0,traditional:!0,data:{x01:"UPLOAD",x02:e.name,x03:e.type,f01:m,p_request:"PLUGIN="+d,p_flow_id:$v("pFlowId"),p_flow_step_id:$v("pFlowStepId"),
p_instance:$v("pInstance"),p_debug:$v("pdebug")},success:function(c){apexDropzone.sleepUntil(f);var d;try{d=jQuery.parseJSON(c)}catch(l){apex.debug.log("uploadDzFiles Response ParseError",l),d=jQuery.parseJSON('{ "status": "error", "message": "uploadDzFiles Response ParseError", "code": "AJAX Callback (pData) ParseError" }')}"error"==d.status?(apex.debug.log("uploadDzFiles Error",d.message,d.code),apex.event.trigger("#"+b,"dropzone-upload-error",d),e.status=Dropzone.ERROR,a.emit("error",e,"Database error during file upload")):
"success"==d.status&&(e.id=d.id,apex.debug.log("uploadDzFiles Success",d.message),apex.event.trigger("#"+b,"dropzone-upload-success",c),e.status=Dropzone.SUCCESS,a.emit("success",e,"success",null));a.emit("uploadprogress",e,100,e.size);a.emit("complete",e);a.processQueue()},error:function(d,c){apexDropzone.sleepUntil(f);apex.debug.log("uploadDzFiles Error",c);apex.event.trigger("#"+b,"dropzone-upload-error",c);e.status=Dropzone.ERROR;a.emit("error",e,c?c:"Error processing file",d);a.emit("complete",
e);a.processQueue()},xhr:function(){XhrObj=$.ajaxSettings.xhr();XhrObj.upload?XhrObj.upload.addEventListener("progress",function(b){apexDropzone.setUploadProgress(b,a,e)},!1):apex.debug.log("uploadDzFiles XHR","Upload progress is not supported.");return XhrObj}})}else apexDropzone.sleepUntil(f),a.processQueue()}}(e);h.readAsArrayBuffer(e)})}},uploadDzFilesChunked:function(b,a,c,d,f,g){for(var e=0;e<c.length;e++){var h=c[e],m;apexDropzone.resizeImage(a,c[e],function(c){c&&(m=h,h=c);var e=new FileReader;
e.onload=function(e){return function(p){if(e){var t,v,l,u=g||1048576,q,n,r=Math.ceil(h.size/u);apexDropzone.asyncLoop(r,function(g){l=g.iteration();q=u*(l-1);n=q+u;apex.debug.log(h.name+" currentChunk",l);apex.debug.log(h.name+" chunkStart",q);apex.debug.log(h.name+" chunkEnd",n);t=h.slice(q,n);var e=new FileReader;e.onload=function(e){return function(e){v=apexDropzone.binaryArray2base64(e.target.result);h.xhr=apex.jQuery.ajax({dataType:"text",type:"POST",url:window.location.href.substr(0,window.location.href.indexOf("/f?p=")+
1)+"wwv_flow.show",async:!0,traditional:!0,data:{x01:"UPLOAD",x02:h.name,x03:h.type,x04:l,x05:r,p_clob_01:v,p_request:"PLUGIN="+d,p_flow_id:$v("pFlowId"),p_flow_step_id:$v("pFlowStepId"),p_instance:$v("pInstance"),p_debug:$v("pdebug")},success:function(d){c&&(h=m);l==r&&apexDropzone.sleepUntil(f);var e;try{e=jQuery.parseJSON(d)}catch(w){apex.debug.log("uploadDzFilesChunked Response ParseError",w),e=jQuery.parseJSON('{ "status": "error", "message": "uploadDzFilesChunked Response ParseError", "code": "AJAX Callback (pData) ParseError" }')}"error"==
e.status?(apex.debug.log("uploadDzFilesChunked Error",e.message,e.code),apex.event.trigger("#"+b,"dropzone-upload-chunk-error",e),h.status=Dropzone.ERROR,a.emit("error",h,"Database error during file upload"),a.emit("complete",h),a.processQueue()):"success"==e.status&&(apex.debug.log("uploadDzFilesChunked Success",e.message),apex.event.trigger("#"+b,"dropzone-upload-chunk-success",d),l==r&&(h.id=e.id,h.status=Dropzone.SUCCESS,a.emit("success",h,"success",null),a.emit("complete",h),a.processQueue()));
c&&(h=c);g.next()},error:function(d,e){c&&(h=m);apexDropzone.sleepUntil(f);apex.debug.log("uploadDzFilesChunked Error",e);apex.event.trigger("#"+b,"dropzone-upload-chunk-error",e);h.status=Dropzone.ERROR;a.emit("error",h,e?e:"Error processing file",d);a.emit("complete",h);a.processQueue()},xhr:function(){XhrObj=$.ajaxSettings.xhr();XhrObj.upload?XhrObj.upload.addEventListener("progress",function(b){apexDropzone.setUploadProgressChunked(b,a,l,r,m||h)},!1):apex.debug.log("uploadDzFilesChunked XHR",
"Upload progress is not supported.");return XhrObj}})}}(t);e.readAsArrayBuffer(t)},function(){apex.debug.log("uploadDzFilesChunked Loop ended")})}else apexDropzone.sleepUntil(f),a.processQueue()}}(h);e.readAsArrayBuffer(h)})}},deleteDzFile:function(b,a,c,d){apex.jQuery.ajax({dataType:"text",type:"POST",url:window.location.href.substr(0,window.location.href.indexOf("/f?p=")+1)+"wwv_flow.show",async:!0,traditional:!0,data:{x01:"DELETE",x02:c.name,x03:c.id,p_request:"PLUGIN="+d,p_flow_id:$v("pFlowId"),
p_flow_step_id:$v("pFlowStepId"),p_instance:$v("pInstance"),p_debug:$v("pdebug")},success:function(a){var c;try{c=jQuery.parseJSON(a)}catch(e){apex.debug.log("deleteDzFile Response ParseError",e),c=jQuery.parseJSON('{ "status": "error", "message": "deleteDzFile Response ParseError", "code": "AJAX Callback (pData) ParseError" }')}"error"==c.status?(apex.debug.log("deleteDzFile Error",c.message,c.code),apex.event.trigger("#"+b,"dropzone-delete-error",c)):"success"==c.status&&(apex.debug.log("deleteDzFile Success",
c.message),apex.event.trigger("#"+b,"dropzone-delete-success",a))},error:function(a,c){apex.debug.log("deleteDzFile Error",c);apex.event.trigger("#"+b,"dropzone-delete-error",c)}})},apexDropzoneFnc:function(b,a){var c=jQuery("#"+apex.util.escapeCSS(b+"_dropzone"),apex.gPageContext$),d=apex.util.escapeCSS(b+"_dropzone"),f=a.ajaxIdentifier,g=parseFloat(a.maxFilesize),e=parseInt(a.maxFiles),h=parseInt(a.parallelUploads),m=a.acceptedFiles,p=parseInt(a.waitTime),x=a.uploadMechanism,y=apexDropzone.parseBoolean(a.clickable),
z=apexDropzone.parseBoolean(a.showFilePreview),t=apexDropzone.parseBoolean(a.supportCopyPaste),v=apexDropzone.parseBoolean(a.removeAfterUpload),l=apexDropzone.parseBoolean(a.deleteFiles),u=apexDropzone.parseBoolean(a.resizeImages),q=parseInt(a.resizeWidth),n=parseInt(a.resizeHeight),r=a.pluginPrefix,A=parseInt(a.chunkSize),B=a.displayMessage,C=a.fallbackMessage,D=a.fileTooBigMessage,E=a.maxFilesMessage,F=a.removeFileMessage,w=a.cancelUploadMessage,G=a.cancelUploadConfirmMessage,H=a.invalidFileTypeMessage;
apex.debug.log("apexDropzoneFnc - pRegionId",b);apex.debug.log("apexDropzoneFnc - pOptions",a);apex.debug.log("apexDropzoneFnc - vRegion",d);apex.debug.log("apexDropzoneFnc - vRegion$",c);apex.debug.log("apexDropzoneFnc - vAjaxIdentifier",f);apex.debug.log("apexDropzoneFnc - vMaxFileSize",g);apex.debug.log("apexDropzoneFnc - vMaxFiles",e);apex.debug.log("apexDropzoneFnc - vParallelUploads",h);apex.debug.log("apexDropzoneFnc - vAcceptedFiles",m);apex.debug.log("apexDropzoneFnc - vWaitTime",p);apex.debug.log("apexDropzoneFnc - vUploadMechanism",
x);apex.debug.log("apexDropzoneFnc - vClickable",y);apex.debug.log("apexDropzoneFnc - vShowFilePreview",z);apex.debug.log("apexDropzoneFnc - vCopyPaste",t);apex.debug.log("apexDropzoneFnc - vRemoveAfterUpload",v);apex.debug.log("apexDropzoneFnc - vDeleteFiles",l);apex.debug.log("apexDropzoneFnc - vResizeImages",u);apex.debug.log("apexDropzoneFnc - vResizeWidth",q);apex.debug.log("apexDropzoneFnc - vResizeHeight",n);apex.debug.log("apexDropzoneFnc - vPluginPrefix",r);apex.debug.log("apexDropzoneFnc - vChunkSize",
A);apex.debug.log("apexDropzoneFnc - vDisplayMessage",B);apex.debug.log("apexDropzoneFnc - vFallbackMessage",C);apex.debug.log("apexDropzoneFnc - vFileTooBigMessage",D);apex.debug.log("apexDropzoneFnc - vMaxFilesMessage",E);apex.debug.log("apexDropzoneFnc - vRemoveFileMessage",F);apex.debug.log("apexDropzoneFnc - vCancelUploadMessage",w);apex.debug.log("apexDropzoneFnc - vCancelUploadConfirmMessage",G);apex.debug.log("apexDropzoneFnc - vInvalidFileTypeMessage",H);u?(c=q||null,n=n||null):n=c=null;
g={url:window.location.href.substr(0,window.location.href.indexOf("/f?p=")+1)+"wwv_flow.show",uploadMultiple:!1,autoProcessQueue:!0,addRemoveLinks:l,parallelUploads:h,maxFilesize:g,clickable:y,maxFiles:e,acceptedFiles:m,resizeWidth:c,resizeHeight:n,dictDefaultMessage:B,dictFallbackMessage:C,dictFileTooBig:D,dictMaxFilesExceeded:E,dictRemoveFile:F,dictCancelUpload:w,dictCancelUploadConfirmation:G,dictInvalidFileType:H};Dropzone.autoDiscover=!1;var k=new Dropzone("div#"+d,g);y||$(".dz-hidden-input").prop("disabled",
!0);t&&FileReaderJS.setupClipboard(document.body,{readAsDefault:"DataURL",accept:{"image/*":"DataURL"},on:{load:function(b,a){k.addFile(a)}}});k.uploadFiles=function(a){"NORMAL"==x?apexDropzone.uploadDzFiles(b,k,a,f,p):"CHUNKED"==x&&apexDropzone.uploadDzFilesChunked(b,k,a,f,p,A)};if(l)k.on("removedfile",function(a){apex.event.trigger("#"+b,"dropzone-deleted-file",a);apexDropzone.deleteDzFile(b,k,a,f)});k.on("addedfile",function(c){apex.event.trigger("#"+b,"dropzone-added-file",c);if(z&&!c.type.match(/image.*/)){var d=
c.name.split(".").pop();apexDropzone.imageExists(a.pluginPrefix+"img/"+d+".png",function(){$(c.previewElement).find(".dz-image img").attr("src",a.pluginPrefix+"img/"+d+".png")},function(){$(c.previewElement).find(".dz-image img").attr("src",a.pluginPrefix+"img/other.png")})}});k.on("maxfilesexceeded",function(a){apex.event.trigger("#"+b,"dropzone-maxfiles-exceeded",a)});k.on("totaluploadprogress",function(a){apex.event.trigger("#"+b,"dropzone-totalupload-progress",a)});k.on("dragenter",function(){apex.event.trigger("#"+
b,"dropzone-drag-over")});k.on("error",function(a,c){a.errorMessage=c;apex.event.trigger("#"+b,"dropzone-file-error",a)});k.on("complete",function(){0===k.getQueuedFiles().length&&0===k.getUploadingFiles().length&&(apex.event.trigger("#"+b,"dropzone-upload-complete"),v&&setTimeout(function(){k.removeAllFiles()},3E3))})}};
