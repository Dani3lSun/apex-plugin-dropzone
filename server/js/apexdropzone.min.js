var $jscomp={scope:{},findInternal:function(b,a,c){b instanceof String&&(b=String(b));for(var d=b.length,g=0;g<d;g++){var e=b[g];if(a.call(c,e,g,b))return{i:g,v:e}}return{i:-1,v:void 0}}};$jscomp.defineProperty="function"==typeof Object.defineProperties?Object.defineProperty:function(b,a,c){if(c.get||c.set)throw new TypeError("ES3 does not support getters and setters.");b!=Array.prototype&&b!=Object.prototype&&(b[a]=c.value)};
$jscomp.getGlobal=function(b){return"undefined"!=typeof window&&window===b?b:"undefined"!=typeof global&&null!=global?global:b};$jscomp.global=$jscomp.getGlobal(this);$jscomp.polyfill=function(b,a,c,d){if(a){c=$jscomp.global;b=b.split(".");for(d=0;d<b.length-1;d++){var g=b[d];g in c||(c[g]={});c=c[g]}b=b[b.length-1];d=c[b];a=a(d);a!=d&&null!=a&&$jscomp.defineProperty(c,b,{configurable:!0,writable:!0,value:a})}};
$jscomp.polyfill("Array.prototype.find",function(b){return b?b:function(b,c){return $jscomp.findInternal(this,b,c).v}},"es6-impl","es3");
var apexDropzone={parseBoolean:function(b){var a;"true"==b.toLowerCase()&&(a=!0);"false"==b.toLowerCase()&&(a=!1);"true"!=b.toLowerCase()&&"false"!=b.toLowerCase()&&(a=void 0);return a},imageExists:function(b,a,c){try{var d=new Image;d.onload=a;d.onerror=c;d.src=b}catch(g){console.log(g)}},clob2Array:function(b,a,c){loopCount=Math.floor(b.length/a)+1;for(var d=0;d<loopCount;d++)c.push(b.slice(a*d,a*(d+1)));return c},binaryArray2base64:function(b){var a="";b=new Uint8Array(b);for(var c=b.byteLength,
d=0;d<c;d++)a+=String.fromCharCode(b[d]);return btoa(a)},sleepUntil:function(b){for(var a=(new Date).getTime();new Date<a+b;);return!0},setUploadProgress:function(b,a,c){var d;null!=b?(d=b.loaded/b.total*100,c.upload={progress:d,total:b.total,bytesSent:b.loaded}):(d=100,c.upload={progress:d,bytesSent:c.upload.total});a.emit("uploadprogress",c,d,c.size/(100/d))},setUploadProgressChunked:function(b,a,c,d,g){var e;null!=b?(e=c/d*100+b.loaded/b.total*100/d,g.upload={progress:e,total:c/d*b.total,bytesSent:c/
d*b.loaded}):(e=c/d*100,g.upload={progress:e,bytesSent:c/d*g.upload.total});a.emit("uploadprogress",g,e,g.size/(100/e))},asyncLoop:function(b,a,c){var d=1,g=!1,e={next:function(){g||(d<=b?(d++,a(e)):(g=!0,c()))},iteration:function(){return d-1},"break":function(){g=!0;c()}};e.next();return e},uploadDzFiles:function(b,a,c,d,g){for(var e=0;e<c.length;e++){var f=c[e],k=new FileReader;k.onload=function(c){return function(e){if(c){e=apexDropzone.binaryArray2base64(e.target.result);var l=[],l=apexDropzone.clob2Array(e,
3E4,l);a.emit("uploadprogress",f,10,f.size/10);f.xhr=apex.jQuery.ajax({dataType:"text",type:"POST",url:window.location.href.substr(0,window.location.href.indexOf("/f?p=")+1)+"wwv_flow.show",async:!0,traditional:!0,data:{x01:"UPLOAD",x02:f.name,x03:f.type,f01:l,p_request:"PLUGIN="+d,p_flow_id:$v("pFlowId"),p_flow_step_id:$v("pFlowStepId"),p_instance:$v("pInstance"),p_debug:$v("pdebug")},success:function(c){apexDropzone.sleepUntil(g);var d;try{d=jQuery.parseJSON(c)}catch(n){apex.debug.log("uploadDzFiles Response ParseError",
n),d=jQuery.parseJSON('{ "status": "error", "message": "uploadDzFiles Response ParseError", "code": "AJAX Callback (pData) ParseError" }')}"error"==d.status?(apex.debug.log("uploadDzFiles Error",d.message,d.code),apex.event.trigger("#"+b,"dropzone-upload-error",d),f.status=Dropzone.ERROR,a.emit("error",f,"Database error during file upload")):"success"==d.status&&(f.id=d.id,apex.debug.log("uploadDzFiles Success",d.message),apex.event.trigger("#"+b,"dropzone-upload-success",c),f.status=Dropzone.SUCCESS,
a.emit("success",f,"success",null));a.emit("uploadprogress",f,100,f.size);a.emit("complete",f);a.processQueue()},error:function(d,c){apexDropzone.sleepUntil(g);apex.debug.log("uploadDzFiles Error",c);apex.event.trigger("#"+b,"dropzone-upload-error",c);f.status=Dropzone.ERROR;a.emit("error",f,c?c:"Error processing file",d);a.emit("complete",f);a.processQueue()},xhr:function(){XhrObj=$.ajaxSettings.xhr();XhrObj.upload?XhrObj.upload.addEventListener("progress",function(b){apexDropzone.setUploadProgress(b,
a,f)},!1):console.log("Upload progress is not supported.");return XhrObj}})}else apexDropzone.sleepUntil(g),a.processQueue()}}(f);k.readAsArrayBuffer(f)}},uploadDzFilesChunked:function(b,a,c,d,g){for(var e=0;e<c.length;e++){var f=c[e],k=new FileReader;k.onload=function(c){return function(e){if(c){var l,m,k,n,p=Math.ceil(f.size/1048576);apexDropzone.asyncLoop(p,function(c){m=c.iteration();k=1048576*(m-1);n=k+1048576;apex.debug.log(f.name+" currentChunk",m);apex.debug.log(f.name+" chunkStart",k);apex.debug.log(f.name+
" chunkEnd",n);l=f.slice(k,n);var e=new FileReader;e.onload=function(e){return function(e){e=apexDropzone.binaryArray2base64(e.target.result);f.xhr=apex.jQuery.ajax({dataType:"text",type:"POST",url:window.location.href.substr(0,window.location.href.indexOf("/f?p=")+1)+"wwv_flow.show",async:!0,traditional:!0,data:{x01:"UPLOAD",x02:f.name,x03:f.type,x04:m,x05:p,p_clob_01:e,p_request:"PLUGIN="+d,p_flow_id:$v("pFlowId"),p_flow_step_id:$v("pFlowStepId"),p_instance:$v("pInstance"),p_debug:$v("pdebug")},
success:function(d){m==p&&apexDropzone.sleepUntil(g);var e;try{e=jQuery.parseJSON(d)}catch(q){apex.debug.log("uploadDzFilesChunked Response ParseError",q),e=jQuery.parseJSON('{ "status": "error", "message": "uploadDzFilesChunked Response ParseError", "code": "AJAX Callback (pData) ParseError" }')}"error"==e.status?(apex.debug.log("uploadDzFilesChunked Error",e.message,e.code),apex.event.trigger("#"+b,"dropzone-upload-chunk-error",e),f.status=Dropzone.ERROR,a.emit("error",f,"Database error during file upload"),
a.emit("complete",f),a.processQueue()):"success"==e.status&&(apex.debug.log("uploadDzFilesChunked Success",e.message),apex.event.trigger("#"+b,"dropzone-upload-chunk-success",d),m==p&&(f.id=e.id,f.status=Dropzone.SUCCESS,a.emit("success",f,"success",null),a.emit("complete",f),a.processQueue()));c.next()},error:function(d,c){apexDropzone.sleepUntil(g);apex.debug.log("uploadDzFilesChunked Error",c);apex.event.trigger("#"+b,"dropzone-upload-chunk-error",c);f.status=Dropzone.ERROR;a.emit("error",f,c?
c:"Error processing file",d);a.emit("complete",f);a.processQueue()},xhr:function(){XhrObj=$.ajaxSettings.xhr();XhrObj.upload?XhrObj.upload.addEventListener("progress",function(b){apexDropzone.setUploadProgressChunked(b,a,m,p,f)},!1):console.log("Upload progress is not supported.");return XhrObj}})}}(l);e.readAsArrayBuffer(l)},function(){apex.debug.log("uploadDzFilesChunked Loop ended")})}else apexDropzone.sleepUntil(g),a.processQueue()}}(f);k.readAsArrayBuffer(f)}},deleteDzFile:function(b,a,c,d){apex.jQuery.ajax({dataType:"text",
type:"POST",url:window.location.href.substr(0,window.location.href.indexOf("/f?p=")+1)+"wwv_flow.show",async:!0,traditional:!0,data:{x01:"DELETE",x02:c.name,x03:c.id,p_request:"PLUGIN="+d,p_flow_id:$v("pFlowId"),p_flow_step_id:$v("pFlowStepId"),p_instance:$v("pInstance"),p_debug:$v("pdebug")},success:function(a){var c;try{c=jQuery.parseJSON(a)}catch(f){apex.debug.log("deleteDzFile Response ParseError",f),c=jQuery.parseJSON('{ "status": "error", "message": "deleteDzFile Response ParseError", "code": "AJAX Callback (pData) ParseError" }')}"error"==
c.status?(apex.debug.log("deleteDzFile Error",c.message,c.code),apex.event.trigger("#"+b,"dropzone-delete-error",c)):"success"==c.status&&(apex.debug.log("deleteDzFile Success",c.message),apex.event.trigger("#"+b,"dropzone-delete-success",a))},error:function(a,c){apex.debug.log("deleteDzFile Error",c);apex.event.trigger("#"+b,"dropzone-delete-error",c)}})},apexDropzoneFnc:function(b,a){var c=jQuery("#"+apex.util.escapeCSS(b+"_dropzone"),apex.gPageContext$),d=apex.util.escapeCSS(b+"_dropzone"),g=a.ajaxIdentifier,
e=parseFloat(a.maxFilesize),f=parseInt(a.maxFiles),k=parseInt(a.parallelUploads),t=a.acceptedFiles,r=parseInt(a.waitTime),l=a.uploadMechanism,m=apexDropzone.parseBoolean(a.clickable),u=apexDropzone.parseBoolean(a.showFilePreview),n=apexDropzone.parseBoolean(a.supportCopyPaste),p=apexDropzone.parseBoolean(a.removeAfterUpload),v=apexDropzone.parseBoolean(a.deleteFiles),C=a.pluginPrefix,w=a.displayMessage,x=a.fileTooBigMessage,y=a.maxFilesMessage,z=a.removeFileMessage,q=a.cancelUploadMessage,A=a.cancelUploadConfirmMessage,
B=a.invalidFileTypeMessage;apex.debug.log("apexDropzoneFnc - pRegionId",b);apex.debug.log("apexDropzoneFnc - pOptions",a);apex.debug.log("apexDropzoneFnc - vRegion",d);apex.debug.log("apexDropzoneFnc - vRegion$",c);apex.debug.log("apexDropzoneFnc - vAjaxIdentifier",g);apex.debug.log("apexDropzoneFnc - vMaxFileSize",e);apex.debug.log("apexDropzoneFnc - vMaxFiles",f);apex.debug.log("apexDropzoneFnc - vParallelUploads",k);apex.debug.log("apexDropzoneFnc - vAcceptedFiles",t);apex.debug.log("apexDropzoneFnc - vWaitTime",
r);apex.debug.log("apexDropzoneFnc - vUploadMechanism",l);apex.debug.log("apexDropzoneFnc - vClickable",m);apex.debug.log("apexDropzoneFnc - vShowFilePreview",u);apex.debug.log("apexDropzoneFnc - vCopyPaste",n);apex.debug.log("apexDropzoneFnc - vRemoveAfterUpload",p);apex.debug.log("apexDropzoneFnc - vPluginPrefix",C);apex.debug.log("apexDropzoneFnc - vDisplayMessage",w);apex.debug.log("apexDropzoneFnc - vFileTooBigMessage",x);apex.debug.log("apexDropzoneFnc - vMaxFilesMessage",y);apex.debug.log("apexDropzoneFnc - vRemoveFileMessage",
z);apex.debug.log("apexDropzoneFnc - vCancelUploadMessage",q);apex.debug.log("apexDropzoneFnc - vCancelUploadConfirmMessage",A);apex.debug.log("apexDropzoneFnc - vInvalidFileTypeMessage",B);Dropzone.autoDiscover=!1;var h=new Dropzone("div#"+d,{url:window.location.href.substr(0,window.location.href.indexOf("/f?p=")+1)+"wwv_flow.show",uploadMultiple:!1,autoProcessQueue:!0,addRemoveLinks:v,parallelUploads:k,maxFilesize:e,clickable:m,maxFiles:f,acceptedFiles:t,dictDefaultMessage:w,dictFileTooBig:x,dictMaxFilesExceeded:y,
dictRemoveFile:z,dictCancelUpload:q,dictCancelUploadConfirmation:A,dictInvalidFileType:B});m||$(".dz-hidden-input").prop("disabled",!0);n&&FileReaderJS.setupClipboard(document.body,{readAsDefault:"DataURL",accept:{"image/*":"DataURL"},on:{load:function(b,a){h.addFile(a)}}});h.uploadFiles=function(a){"NORMAL"==l?apexDropzone.uploadDzFiles(b,h,a,g,r):"CHUNKED"==l&&apexDropzone.uploadDzFilesChunked(b,h,a,g,r)};if(v)h.on("removedfile",function(a){apex.event.trigger("#"+b,"dropzone-deleted-file",a);apexDropzone.deleteDzFile(b,
h,a,g)});h.on("addedfile",function(c){apex.event.trigger("#"+b,"dropzone-added-file",c);if(u&&!c.type.match(/image.*/)){var d=c.name.split(".").pop();apexDropzone.imageExists(a.pluginPrefix+"img/"+d+".png",function(){$(c.previewElement).find(".dz-image img").attr("src",a.pluginPrefix+"img/"+d+".png")},function(){$(c.previewElement).find(".dz-image img").attr("src",a.pluginPrefix+"img/other.png")})}});h.on("maxfilesexceeded",function(a){apex.event.trigger("#"+b,"dropzone-maxfiles-exceeded",a)});h.on("totaluploadprogress",
function(a){apex.event.trigger("#"+b,"dropzone-totalupload-progress",a)});h.on("dragenter",function(){apex.event.trigger("#"+b,"dropzone-drag-over")});h.on("error",function(a,c){a.errorMessage=c;apex.event.trigger("#"+b,"dropzone-file-error",a)});h.on("complete",function(){0===h.getQueuedFiles().length&&0===h.getUploadingFiles().length&&(apex.event.trigger("#"+b,"dropzone-upload-complete"),p&&setTimeout(function(){h.removeAllFiles()},3E3))})}};
