var $jscomp={scope:{},findInternal:function(a,b,d){a instanceof String&&(a=String(a));for(var c=a.length,f=0;f<c;f++){var e=a[f];if(b.call(d,e,f,a))return{i:f,v:e}}return{i:-1,v:void 0}}};$jscomp.defineProperty="function"==typeof Object.defineProperties?Object.defineProperty:function(a,b,d){if(d.get||d.set)throw new TypeError("ES3 does not support getters and setters.");a!=Array.prototype&&a!=Object.prototype&&(a[b]=d.value)};
$jscomp.getGlobal=function(a){return"undefined"!=typeof window&&window===a?a:"undefined"!=typeof global&&null!=global?global:a};$jscomp.global=$jscomp.getGlobal(this);$jscomp.polyfill=function(a,b,d,c){if(b){d=$jscomp.global;a=a.split(".");for(c=0;c<a.length-1;c++){var f=a[c];f in d||(d[f]={});d=d[f]}a=a[a.length-1];c=d[a];b=b(c);b!=c&&null!=b&&$jscomp.defineProperty(d,a,{configurable:!0,writable:!0,value:b})}};
$jscomp.polyfill("Array.prototype.find",function(a){return a?a:function(a,d){return $jscomp.findInternal(this,a,d).v}},"es6-impl","es3");
var apexDropzone={parseBoolean:function(a){var b;"true"==a.toLowerCase()&&(b=!0);"false"==a.toLowerCase()&&(b=!1);"true"!=a.toLowerCase()&&"false"!=a.toLowerCase()&&(b=void 0);return b},imageExists:function(a,b,d){try{var c=new Image;c.onload=b;c.onerror=d;c.src=a}catch(f){apex.debug.log("apexDropzone.imageExists Error",f)}},clob2Array:function(a,b,d){loopCount=Math.floor(a.length/b)+1;for(var c=0;c<loopCount;c++)d.push(a.slice(b*c,b*(c+1)));return d},binaryArray2base64:function(a){var b="";a=new Uint8Array(a);
for(var d=a.byteLength,c=0;c<d;c++)b+=String.fromCharCode(a[c]);return btoa(b)},setUploadProgress:function(a,b,d){var c;a?(c=a.loaded/a.total*100,100<c&&(c=100),d.upload={progress:c,total:a.total,bytesSent:a.loaded}):(c=100,d.upload={progress:c,bytesSent:d.upload.total});b.emit("uploadprogress",d,c,d.size/(100/c))},setUploadProgressChunked:function(a,b,d,c,f){var e;a?(e=d/c*100+a.loaded/a.total*100/c,100<e&&(e=100),f.upload={progress:e,total:d/c*a.total,bytesSent:d/c*a.loaded}):(e=d/c*100,100<e&&
(e=100),f.upload={progress:e,bytesSent:d/c*f.upload.total});b.emit("uploadprogress",f,e,f.size/(100/e))},asyncLoop:function(a,b,d){var c=1,f=!1,e={next:function(){f||(c<=a?(c++,b(e)):(f=!0,d()))},iteration:function(){return c-1},stop:function(){f=!0;d()}};e.next();return e},processFile:function(a,b,d){if((a.options.resizeWidth||a.options.resizeHeight)&&b.type.match(/image.*/)){var c=a.options.resizeMethod,c=a.options.resizeWidth&&a.options.resizeHeight?"crop":"contain";a.resizeImage(b,a.options.resizeWidth,
a.options.resizeHeight,c,function(a){a.name=b.name;a.status=b.status;a.accepted=b.accepted;a.processing=b.processing;a.lastModified=b.lastModified;a.lastModifiedDate=b.lastModifiedDate;a.previewElement=b.previewElement;a.previewTemplate=b.previewTemplate;a._removeLink=b._removeLink;d(a)})}else d(b)},uploadDzFiles:function(a,b,d,c){for(var f=0;f<c.length;f++){var e=c[f];apexDropzone.processFile(d,c[f],function(c){if(c){var f=e;e=c}var g=new FileReader;g.onload=function(g){return function(n){if(g){c&&
(e=f);n=apexDropzone.binaryArray2base64(n.target.result);var k=[],k=apexDropzone.clob2Array(n,3E4,k);d.emit("uploadprogress",e,10,e.size/10);e.xhr=apex.jQuery.ajax({dataType:"text",type:"POST",url:window.location.href.substr(0,window.location.href.indexOf("/f?p=")+1)+"wwv_flow.show",async:!0,traditional:!0,data:{x01:"UPLOAD",x02:e.name,x03:e.type,f01:k,p_request:"PLUGIN="+b,p_flow_id:$v("pFlowId"),p_flow_step_id:$v("pFlowStepId"),p_instance:$v("pInstance"),p_debug:$v("pdebug")},success:function(b){var c;
try{c=jQuery.parseJSON(b)}catch(l){apex.debug.log("apexDropzone.uploadDzFiles Response ParseError",l),c=jQuery.parseJSON('{ "status": "error", "message": "uploadDzFiles Response ParseError", "code": "AJAX Callback (pData) ParseError" }')}"error"==c.status?(apex.debug.log("apexDropzone.uploadDzFiles Error",c.message,c.code),apex.event.trigger("#"+a,"dropzone-upload-error",c),e.status=Dropzone.ERROR,d.emit("error",e,"Database error during file upload")):"success"==c.status&&(e.id=c.id,apex.debug.log("apexDropzone.uploadDzFiles Success",
c.message),apex.event.trigger("#"+a,"dropzone-upload-success",b),e.status=Dropzone.SUCCESS,d.emit("success",e,"success",null));d.emit("uploadprogress",e,100,e.size);d.emit("complete",e);d.processQueue()},error:function(b,c){apex.debug.log("apexDropzone.uploadDzFiles Error",c);apex.event.trigger("#"+a,"dropzone-upload-error",c);e.status=Dropzone.ERROR;d.emit("error",e,c?c:"Error processing file",b);d.emit("complete",e);d.processQueue()},xhr:function(){XhrObj=$.ajaxSettings.xhr();XhrObj.upload?XhrObj.upload.addEventListener("progress",
function(a){apexDropzone.setUploadProgress(a,d,e)},!1):apex.debug.log("apexDropzone.uploadDzFiles XHR","Upload progress is not supported.");return XhrObj}})}else d.processQueue()}}(e);g.readAsArrayBuffer(e)})}},uploadDzFilesChunked:function(a,b,d,c,f){for(var e=0;e<c.length;e++){var g=c[e],k;apexDropzone.processFile(d,c[e],function(c){c&&(k=g,g=c);var e=new FileReader;e.onload=function(e){return function(n){if(e){var q,r,l,t=f||1048576,m,u,p=Math.ceil(g.size/t);apexDropzone.asyncLoop(p,function(e){l=
e.iteration();m=t*(l-1);u=m+t;apex.debug.log(g.name+" currentChunk",l);apex.debug.log(g.name+" chunkStart",m);apex.debug.log(g.name+" chunkEnd",u);q=g.slice(m,u);var f=new FileReader;f.onload=function(f){return function(f){r=apexDropzone.binaryArray2base64(f.target.result);g.xhr=apex.jQuery.ajax({dataType:"text",type:"POST",url:window.location.href.substr(0,window.location.href.indexOf("/f?p=")+1)+"wwv_flow.show",async:!0,traditional:!0,data:{x01:"UPLOAD",x02:g.name,x03:g.type,x04:l,x05:p,p_clob_01:r,
p_request:"PLUGIN="+b,p_flow_id:$v("pFlowId"),p_flow_step_id:$v("pFlowStepId"),p_instance:$v("pInstance"),p_debug:$v("pdebug")},success:function(b){c&&(g=k);var f;try{f=jQuery.parseJSON(b)}catch(v){apex.debug.log("apexDropzone.uploadDzFilesChunked Response ParseError",v),f=jQuery.parseJSON('{ "status": "error", "message": "uploadDzFilesChunked Response ParseError", "code": "AJAX Callback (pData) ParseError" }')}"error"==f.status?(apex.debug.log("apexDropzone.uploadDzFilesChunked Error",f.message,
f.code),apex.event.trigger("#"+a,"dropzone-upload-chunk-error",f),g.status=Dropzone.ERROR,d.emit("error",g,"Database error during file upload"),d.emit("complete",g),d.processQueue()):"success"==f.status&&(apex.debug.log("apexDropzone.uploadDzFilesChunked Success",f.message),apex.event.trigger("#"+a,"dropzone-upload-chunk-success",b),l==p&&(g.id=f.id,g.status=Dropzone.SUCCESS,d.emit("success",g,"success",null),d.emit("complete",g),d.processQueue()));c&&(g=c);e.next()},error:function(b,e){c&&(g=k);
apex.debug.log("apexDropzone.uploadDzFilesChunked Error",e);apex.event.trigger("#"+a,"dropzone-upload-chunk-error",e);g.status=Dropzone.ERROR;d.emit("error",g,e?e:"Error processing file",b);d.emit("complete",g);d.processQueue()},xhr:function(){XhrObj=$.ajaxSettings.xhr();XhrObj.upload?XhrObj.upload.addEventListener("progress",function(a){apexDropzone.setUploadProgressChunked(a,d,l,p,k||g)},!1):apex.debug.log("apexDropzone.uploadDzFilesChunked XHR","Upload progress is not supported.");return XhrObj}})}}(q);
f.readAsArrayBuffer(q)},function(){apex.debug.log("apexDropzone.uploadDzFilesChunked Loop ended")})}else d.processQueue()}}(g);e.readAsArrayBuffer(g)})}},deleteDzFile:function(a,b,d,c){apex.jQuery.ajax({dataType:"text",type:"POST",url:window.location.href.substr(0,window.location.href.indexOf("/f?p=")+1)+"wwv_flow.show",async:!0,traditional:!0,data:{x01:"DELETE",x02:c.name,x03:c.id,p_request:"PLUGIN="+b,p_flow_id:$v("pFlowId"),p_flow_step_id:$v("pFlowStepId"),p_instance:$v("pInstance"),p_debug:$v("pdebug")},
success:function(b){var c;try{c=jQuery.parseJSON(b)}catch(g){apex.debug.log("apexDropzone.deleteDzFile Response ParseError",g),c=jQuery.parseJSON('{ "status": "error", "message": "deleteDzFile Response ParseError", "code": "AJAX Callback (pData) ParseError" }')}"error"==c.status?(apex.debug.log("apexDropzone.deleteDzFile Error",c.message,c.code),apex.event.trigger("#"+a,"dropzone-delete-error",c)):"success"==c.status&&(apex.debug.log("apexDropzone.deleteDzFile Success",c.message),apex.event.trigger("#"+
a,"dropzone-delete-success",b))},error:function(b,c){apex.debug.log("apexDropzone.deleteDzFile Error",c);apex.event.trigger("#"+a,"dropzone-delete-error",c)}})},handlePluginEvents:function(a,b){a.on("removedfile",function(a){apex.debug.log("apexDropzone.handlePluginEvents - removedfile event");apex.event.trigger("#"+b,"dropzone-deleted-file",a)});a.on("addedfile",function(a){apex.debug.log("apexDropzone.handlePluginEvents - addedfile event");apex.event.trigger("#"+b,"dropzone-added-file",a)});a.on("maxfilesexceeded",
function(a){apex.debug.log("apexDropzone.handlePluginEvents - maxfilesexceeded event");apex.event.trigger("#"+b,"dropzone-maxfiles-exceeded",a)});a.on("totaluploadprogress",function(a){apex.debug.log("apexDropzone.handlePluginEvents - totaluploadprogress event");apex.event.trigger("#"+b,"dropzone-totalupload-progress",a)});a.on("dragenter",function(){apex.debug.log("apexDropzone.handlePluginEvents - dragenter event");apex.event.trigger("#"+b,"dropzone-drag-over")});a.on("error",function(a,c){apex.debug.log("apexDropzone.handlePluginEvents - error event");
a.errorMessage=c;apex.event.trigger("#"+b,"dropzone-file-error",a)});a.on("complete",function(){0===a.getQueuedFiles().length&&0===a.getUploadingFiles().length&&(apex.debug.log("apexDropzone.handlePluginEvents - complete event"),apex.event.trigger("#"+b,"dropzone-upload-complete"))})},pluginHandler:function(a,b){var d=jQuery("#"+apex.util.escapeCSS(a+"_dropzone"),apex.gPageContext$),c=apex.util.escapeCSS(a+"_dropzone"),f=b.ajaxIdentifier,e=parseFloat(b.maxFilesize),g=parseInt(b.maxFiles),k=b.acceptedFiles,
n=b.uploadMechanism,w=apexDropzone.parseBoolean(b.clickable),x=apexDropzone.parseBoolean(b.showFilePreview),y=apexDropzone.parseBoolean(b.supportCopyPaste),q=apexDropzone.parseBoolean(b.removeAfterUpload),r=apexDropzone.parseBoolean(b.deleteFiles),l=apexDropzone.parseBoolean(b.resizeImages),t=parseInt(b.resizeWidth),m=parseInt(b.resizeHeight),u=b.pluginPrefix,p=parseInt(b.chunkSize),z=b.displayMessage,A=b.fallbackMessage,B=b.fileTooBigMessage,C=b.maxFilesMessage,D=b.removeFileMessage,E=b.cancelUploadMessage,
v=b.cancelUploadConfirmMessage,F=b.invalidFileTypeMessage;apex.debug.log("apexDropzone.pluginHandler - pRegionId",a);apex.debug.log("apexDropzone.pluginHandler - pOptions",b);apex.debug.log("apexDropzone.pluginHandler - region",c);apex.debug.log("apexDropzone.pluginHandler - region$",d);apex.debug.log("apexDropzone.pluginHandler - ajaxIdentifier",f);apex.debug.log("apexDropzone.pluginHandler - maxFileSize",e);apex.debug.log("apexDropzone.pluginHandler - maxFiles",g);apex.debug.log("apexDropzone.pluginHandler - acceptedFiles",
k);apex.debug.log("apexDropzone.pluginHandler - uploadMechanism",n);apex.debug.log("apexDropzone.pluginHandler - clickable",w);apex.debug.log("apexDropzone.pluginHandler - showFilePreview",x);apex.debug.log("apexDropzone.pluginHandler - supportCopyPaste",y);apex.debug.log("apexDropzone.pluginHandler - removeAfterUpload",q);apex.debug.log("apexDropzone.pluginHandler - deleteFiles",r);apex.debug.log("apexDropzone.pluginHandler - resizeImages",l);apex.debug.log("apexDropzone.pluginHandler - resizeWidth",
t);apex.debug.log("apexDropzone.pluginHandler - resizeHeight",m);apex.debug.log("apexDropzone.pluginHandler - pluginPrefix",u);apex.debug.log("apexDropzone.pluginHandler - chunkSize",p);apex.debug.log("apexDropzone.pluginHandler - displayMessage",z);apex.debug.log("apexDropzone.pluginHandler - fallbackMessage",A);apex.debug.log("apexDropzone.pluginHandler - fileTooBigMessage",B);apex.debug.log("apexDropzone.pluginHandler - maxFilesMessage",C);apex.debug.log("apexDropzone.pluginHandler - removeFileMessage",
D);apex.debug.log("apexDropzone.pluginHandler - cancelUploadMessage",E);apex.debug.log("apexDropzone.pluginHandler - cancelUploadConfirmMessage",v);apex.debug.log("apexDropzone.pluginHandler - invalidFileTypeMessage",F);l?(d=t||null,m=m||null):m=d=null;e={url:window.location.href.substr(0,window.location.href.indexOf("/f?p=")+1)+"wwv_flow.show",uploadMultiple:!1,autoProcessQueue:!0,parallelUploads:1,addRemoveLinks:r,maxFilesize:e,clickable:w,maxFiles:g,acceptedFiles:k,resizeWidth:d,resizeHeight:m,
dictDefaultMessage:z,dictFallbackMessage:A,dictFileTooBig:B,dictMaxFilesExceeded:C,dictRemoveFile:D,dictCancelUpload:E,dictCancelUploadConfirmation:v,dictInvalidFileType:F};Dropzone.autoDiscover=!1;var h=new Dropzone("div#"+c,e);w||$(".dz-hidden-input").prop("disabled",!0);y&&FileReaderJS.setupClipboard(document.body,{readAsDefault:"DataURL",accept:{"image/*":"DataURL"},on:{load:function(a,b){h.addFile(b)}}});h.uploadFiles=function(b){"NORMAL"==n?apexDropzone.uploadDzFiles(a,f,h,b):"CHUNKED"==n&&
apexDropzone.uploadDzFilesChunked(a,f,h,b,p)};apexDropzone.handlePluginEvents(h,a);if(r)h.on("removedfile",function(b){apexDropzone.deleteDzFile(a,f,h,b)});h.on("addedfile",function(a){if(x&&!a.type.match(/image.*/)){var c=a.name.split(".").pop();apexDropzone.imageExists(b.pluginPrefix+"img/"+c+".png",function(){$(a.previewElement).find(".dz-image img").attr("src",b.pluginPrefix+"img/"+c+".png")},function(){$(a.previewElement).find(".dz-image img").attr("src",b.pluginPrefix+"img/other.png")})}});
h.on("complete",function(){0===h.getQueuedFiles().length&&0===h.getUploadingFiles().length&&q&&setTimeout(function(){h.removeAllFiles()},3E3)})}};
