(function(k,r){function u(a){var b=k.URL||k.webkitURL,c=k.Blob,d=k.Worker;if(!(b&&c&&d&&a))return null;a=new c([a]);return new d(b.createObjectURL(a))}function v(a,b){if(l.enabled){var c=m(m({},l.opts),b);a.addEventListener("paste",function(a){for(var b=[],d=(a.clipboardData||{}).items||[],f=0;f<d.length;f++){var g=d[f].getAsFile();if(g){var n=/\/(.*)/.exec(g.type);!g.name&&n&&(g.name="clipboard"+f+"."+n[1]);b.push(g)}}b.length&&(p(a,b,c),a.preventDefault(),a.stopPropagation())},!1)}}function w(a,
b){if(l.enabled){var c=m(m({},l.opts),b);a.addEventListener("change",function(b){p(b,a.files,c)},!1);a.addEventListener("drop",function(a){a.stopPropagation();a.preventDefault();p(a,a.dataTransfer.files,c)},!1)}}function x(a,b){function c(a){return function(){e||a.apply(this,arguments)}}if(l.enabled){var d=m(m({},l.opts),b),h=d.dragClass,e=!1;a.addEventListener("dragenter",c(function(b){b.stopPropagation();b.preventDefault();h&&y(a,h)}),!1);a.addEventListener("dragleave",c(function(b){h&&z(a,h)}),
!1);a.addEventListener("dragover",c(function(b){b.stopPropagation();b.preventDefault();h&&y(a,h)}),!1);a.addEventListener("drop",c(function(b){b.stopPropagation();b.preventDefault();h&&z(a,h);p(b,b.dataTransfer.files,d)}),!1);r.body.addEventListener("dragstart",function(a){e=!0},!0);r.body.addEventListener("dragend",function(a){e=!1},!0);r.body.addEventListener("drop",function(a){a.dataTransfer.files&&a.dataTransfer.files.length&&(a.stopPropagation(),a.preventDefault())},!1)}}function D(a,b){for(var c=
0;c<a.length;c++){var d=a[c],h=d,e=d.name.substring(0,d.name.lastIndexOf(".")),f=d.name.substring(d.name.lastIndexOf(".")+1),g=c,n=E(),d=d.size,A=Math.floor(Math.log(d)/Math.log(1024)),d=(d/Math.pow(1024,Math.floor(A))).toFixed(2)+" "+"bytes kb MB GB TB PB".split(" ")[A];h.extra={nameNoExtension:e,extension:f,fileID:g,uniqueID:n,groupID:b,prettySize:d}}}function F(a,b,c){for(var d in b)if(a.match(new RegExp(d)))return"readAs"+b[d];return"readAs"+c}function p(a,b,c){function d(){f.ended=new Date;c.on.groupend(f)}
function e(){0===--k&&d()}var k=b.length,f={groupID:G(),files:b,started:new Date};l.output.push(f);D(b,f.groupID);c.on.groupstart(f);if(b.length){var g;t&&q&&(g=u("self.addEventListener('message', function(e) { var data=e.data; try { var reader = new FileReaderSync; postMessage({ result: reader[data.readAs](data.file), extra: data.extra, file: data.file})} catch(e){ postMessage({ result:'error', extra:data.extra, file:data.file}); } }, false);"),g.onmessage=function(a){var b=a.data.file,d=a.data.result;
b.extra||(b.extra=a.data.extra);b.extra.ended=new Date;c.on["error"===d?"error":"load"]({target:{result:d}},b);e()});Array.prototype.forEach.call(b,function(b){b.extra.started=new Date;if(c.accept&&!b.type.match(new RegExp(c.accept)))c.on.skip(b),e();else if(!1===c.on.beforestart(b))c.on.skip(b),e();else{var d=F(b.type,c.readAsMap,c.readAsDefault);if(g)g.postMessage({file:b,extra:b.extra,readAs:d});else{var f=new B;f.originalEvent=a;H.forEach(function(a){f["on"+a]=function(d){if("load"==a||"error"==
a)b.extra.ended=new Date;c.on[a](d,b);"loadend"==a&&e()}});f[d](b)}}})}else d()}function I(){var a=u("onmessage = function(e) { postMessage(!!FileReaderSync); };");a&&(a.onmessage=function(a){q=a.data},a.postMessage({}))}function e(){}function m(a,b){for(var c in b)b[c]&&b[c].constructor&&b[c].constructor===Object?(a[c]=a[c]||{},arguments.callee(a[c],b[c])):a[c]=b[c];return a}function C(a,b){return(new RegExp("(?:^|\\s+)"+b+"(?:\\s+|$)")).test(a.className)}function y(a,b){C(a,b)||(a.className=a.className?
[a.className,b].join(" "):b)}function z(a,b){C(a,b)&&(a.className=a.className.replace(new RegExp("(?:^|\\s+)"+b+"(?:\\s+|$)","g")," ").replace(/^\s\s*/,"").replace(/\s\s*$/,""))}var B=k.FileReader,q=!1,H="loadstart progress load abort error loadend".split(" "),t=!1,l=k.FileReaderJS={enabled:!1,setupInput:w,setupDrop:x,setupClipboard:v,setSync:function(a){(t=a)&&!q&&I()},getSync:function(){return t&&q},output:[],opts:{dragClass:"drag",accept:!1,readAsDefault:"DataURL",readAsMap:{},on:{loadstart:e,
progress:e,load:e,abort:e,error:e,loadend:e,skip:e,groupstart:e,groupend:e,beforestart:e}}};"undefined"!==typeof jQuery&&(jQuery.fn.fileReaderJS=function(a){return this.each(function(){jQuery(this).is("input")?w(this,a):x(this,a)})},jQuery.fn.fileClipboard=function(a){return this.each(function(){v(this,a)})});if(B){var G=function(a){return function(){return a++}}(0),E=function(a){return function(){return a++}}(0);l.enabled=!0}})(this,document);
